<?php
namespace App\Controller;

use App\Entity\Requests;
use App\Form\RequestsType;
use App\Repository\RequestsRepository;
use App\Entity\Tutorshipsessions;
use App\Repository\TutorshipSessionRepository;
use Symfony\Bundle\FrameworkBundle\Controller\AbstractController;
use Symfony\Component\HttpFoundation\Request;
use Symfony\Component\HttpFoundation\Response;
use Symfony\Component\Routing\Annotation\Route;
use App\Service\GoogleCalendar;
use App\Entity\Token;
use Symfony\Component\HttpFoundation\RedirectResponse;
use App\Repository\TokenRepository;
use Doctrine\ORM\EntityManagerInterface;

#[Route('/aa')]
class GoogleController extends AbstractController
{
    private GoogleCalendar $googleServices;
    private EntityManagerInterface $entityManager;

    public function __construct(GoogleCalendar $googleServices, EntityManagerInterface $entityManager)
    {
        $this->googleServices = $googleServices;
        $this->entityManager = $entityManager;
    }

 
    #[Route('/callback', name: 'app_google_handle', methods: ['GET'])]
    public function handleGoogle(Request $request): RedirectResponse
    {
        dd("ahla");
        // $code = $request->query->get('code');
        // $token = $this->googleServices->getClient()->fetchAccessTokenWithAuthCode($code);

        // $newToken = (new Token())->setToken($token['access_token']);
        // $this->entityManager->persist($newToken);
        // $this->entityManager->flush();
        // $this->addFlash('success', 'Connected!');

        // return $this->redirectToRoute('app.generate');
    }
}
